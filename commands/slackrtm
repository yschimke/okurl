#!/usr/bin/env okshell

var WebSocketPrinter = Java.type('com.baulsupp.oksocial.ws.WebSocketPrinter');
var TimeUnit = Java.type('java.util.concurrent.TimeUnit');

client = client.newBuilder().readTimeout(0, TimeUnit.MINUTES).build();

var start = query("https://slack.com/api/rtm.start");

print(start);

var request = requestBuilder.url(start.url).build();

var printer = new WebSocketPrinter();
var call = client.newWebSocketCall(request);

call.enqueue(printer);

printer.waitForExit();
